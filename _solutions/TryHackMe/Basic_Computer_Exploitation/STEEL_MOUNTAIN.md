---
layout: solution
category: TryHackMe
contest_code: Basic_Computer_Exploitation
contest_name: Basic Computer Exploitation
problem_code: STEEL_MOUNTAIN
problem_name: Steel Mountain
comments: false
tags: windows powershell
date: 2021-08-20
---

### A basic nmap scan was conducted on the machine and results show that web service is running on port 80 & 8080. RDP service is also running
```
nmap -sV -sC 10.10.242.206
```
![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/nmap.png)

‎


###  Thus the sites were visited, first on port 80, followed by port 8080. 

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/index.png)

‎
<p style="color:orange;">‎By viewing the page source, we would be able to get the first flag (the employee name of the month)</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/inspect.png)

‎
<p style="color:orange;">The other site that runs on port 8080</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/hfs.png)


‎


###  Base on the nmap scan service version of this HFS server, it uses version 2.3 which is vulnerable to Remote Code Execution which is shown on ExploitDB and searchsploit

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/exploitdb.png)

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/searchsploit.png)


‎


### So we can either use Metasploit or non-Metasploit to exploit this vulnerability. For this scenario, I will not be using Metasploit. So I have downloaded the exploitable code from searchsploit for exploitation.

```
searchsploit -m windows/remote/49584.py
```

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/exploit_install.png)

‎
<p style="color:orange;">‎Certain modifications have to be made to the file, such as changing the lhost, rhost, rport, etc before execution and obtaining a reverse shell. This is how we get the next flag</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/configure.png)

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/exploit.png)

‎
<p style="color:orange;">Flag 1</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/flag1.png)


‎


###  Next we need to perform priviledge escalation and to perform that we need to enumerate the machine for local vulnerabilities. There are few tools that can be used like WinPeas or PowerUp, however for this scenario I will try something new (PowerUp). So we need to host PowerUp.ps1 on our webserver and use the shell we got to download and run that PowerShell script (PowerUp)

<p style="color:orange;">Hosting Tools</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/host1.png)

‎
<p style="color:orange;">The Path is vulnerable to unquoted service which is running as a service. We also have permissions to restart the service</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/priv.png)


‎


###   I created a shell payload named Advanced.exe and uploaded it to C:\Program Files (x86)\Iobit. The service was then restarted and a shell was obtained. This is how we get the final flag

<p style="color:orange;">Creating & Hosting Payload</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/host2.png)
‎‎‎‎‎
‎
<p style="color:orange;">Started Listener</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/listener.png)
‎‎‎‎‎
‎
<p style="color:orange;">Replace Legitimate file with malicious payload</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/execute_shell.png)
‎‎‎‎‎
‎
<p style="color:orange;">Received Shell & Obtained final flag</p>

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/escalated.png)

![Image](https://raw.githubusercontent.com/DJShankyShoe/Website/master/assets/Platforms/TryHackMe/Steel%20Mountain/flag2.png)
